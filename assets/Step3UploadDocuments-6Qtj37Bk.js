import{_ as G,r,b as w,c as i,a as e,t as l,F as g,e as C,k as y,w as S,v as J,g as R,h as T,n as K,l as O,d as A,i as Q,o as n,m as W}from"./index-CLYkWNv9.js";import{_ as Y,a as Z,P as x}from"./PdfViewer-B3537JvR.js";import{u as ee}from"./facultyStudentStore-DNdScmBb.js";import{M as V}from"./bootstrap.esm-Ceob_0pG.js";const te={class:"mt-3"},ae={class:"registered-list border rounded vehicle-registration"},le={class:"d-flex justify-content-between align-items-center px-3 py-1 mt-1"},se={class:"m-0 d-flex align-items-center"},oe={key:0,class:"me-3"},ie={key:1},ne={key:2},ce=["onClick"],de={class:"modal fade",id:"deleteModal",tabindex:"-1","aria-labelledby":"deleteModalLabel","aria-hidden":"true"},ue={class:"modal-dialog modal-dialog-centered"},re={class:"modal-content"},pe={class:"modal-header bg-secondary"},_e={class:"modal-title text-black",id:"deleteModalModalLabel"},me={class:"modal-body"},ve={key:0,class:"me-3"},fe={key:1},ge={key:2},ye={class:"modal-footer"},be={class:"mt-5"},he={class:"mb-3"},ke={for:"distance",class:"form-label"},Ce=["value"],Se={class:"mb-3"},Me=["onClick"],De={class:"fs-4 fw-bold px-1 py-3 align-content-center m-0"},Fe={key:0,class:"img-container"},$e=["onClick"],Pe=["onChange"],we={class:"mb-3"},Re={class:"d-flex flex-column flex-md-row gap-md-5"},Te={class:"form-check"},Ae={class:"form-check-label",for:"campusToReceiveCertificate1"},Ve={class:"form-check"},Le={class:"form-check-label",for:"campusToReceiveCertificate2"},Ie={class:"mb-3"},Ee={class:"modal fade",id:"introductionModal",tabindex:"-1","aria-labelledby":"introductionModalLabel","aria-hidden":"true"},Ue={class:"modal-dialog modal-fullscreen modal-dialog-centered"},Be={class:"modal-content"},Ne={class:"modal-header bg-secondary"},je={class:"modal-title text-black",id:"introductionModalModalLabel"},ze={class:"modal-body"},He={class:"modal-footer"},Xe={class:"text-center"},qe=["disabled"],Ge={class:"modal fade",id:"comfirmModal",tabindex:"-1","aria-labelledby":"comfirmModalLabel","aria-hidden":"true"},Je={class:"modal-dialog modal-dialog-centered"},Ke={class:"modal-content"},Oe={class:"modal-header bg-secondary"},Qe={class:"modal-title text-black",id:"comfirmModalLabel"},We={class:"modal-body"},Ye={class:"modal-footer"},Ze={class:"pointer text-primary fw-bold","data-bs-dismiss":"modal"},xe="/NTHU-Parking-Event-Management/documents/國立清華大學校園車輛管理辦法-1130626.pdf",et={__name:"Step3UploadDocuments",setup(tt){const u=ee();let m=null;const L=()=>{const t=document.getElementById("introductionModal");m||(m=new V(t)),m.show()},b=()=>{m&&m.hide()},I=()=>{p.value=!0,b()};let v=null;const d=r({});function E(t){const o=document.getElementById("deleteModal");v||(v=new V(o)),v.show(),d.value=a.value.vehicle_registered_list[t],d.value.index=t}function h(){v&&v.hide()}function U(){a.value.vehicle_registered_list.splice(d.value.index,1),h(),u.setVehicleRegisteredList(a.value.vehicle_registered_list)}const a=r({basic_info:{},vehicle_registered_list:[],selectedCommuteDistance:"",document_list:Array(5).fill(null),campusToReceiveCertificate:"1"});w(()=>{u.getVehicleRegisteredList(),a.value.vehicle_registered_list=u.vehicle_registered_list});const M=[{code:"TC",des:"教職員校內汽車識別證"},{code:"TE",des:"職務宿舍區汽車識別證"},{code:"SC",des:"學生汽車識別證"},{code:"HF",des:"短期汽車識別證"},{code:"TM",des:"教職員機車識別證"},{code:"TEM",des:"職務宿舍區機車識別證"},{code:"SM",des:"學生機車識別證"}],B=["5-10km","10-20km","20-30km","30-40km","40-50km","50km 以上"];a.value.selectedCommuteDistance="5-10km";function N(t,o){const f=t.target.files[0];f&&(a.value.document_list[o]=f)}function j(t){a.value.document_list[t]=null}const p=r(!1);function z(){a.value.vehicle_registered_list=a.value.vehicle_registered_list.flatMap(t=>t.car_type_title==="腳踏車"&&t.bike_num?Array(t.bike_num).fill({plate:t.plate,car_type:t.car_type,car_type_title:t.car_type_title,main_pass_code:t.main_pass_code}):t)}const D=r([]);function H(){D.value=[[{id:"1",title:"車證",form_code:"A00001",created_at:"2024-09-24 20:48:25"},{id:"2",title:"工作證",form_code:"B00002",created_at:"2024-09-24 20:48:25"},{id:"3",title:"活動",form_code:"C00003",created_at:"2024-09-24 20:48:25"},{id:"4",title:"折抵券",form_code:"D00004",created_at:"2024-09-24 20:48:25"},{id:"5",title:"活動+折抵券",form_code:"E00005",created_at:"2024-09-24 20:48:25"}]]}w(()=>{H();const t=D.value.flat().find(o=>o.title==="車證");t&&(a.value.title=t.title,a.value.form_code=t.form_code)});const F=r({});async function X(){const t=[...a.value.document_list];u.getApplicantData(),a.value.basic_info=u.applicant_data,z(),a.value.document_list=a.value.document_list.filter(o=>o!==null),F.value={title:a.value.title,academic_year:a.value.basic_info.academic_year,form_code:a.value.form_code,receive_location:a.value.campusToReceiveCertificate,applicant_type:a.value.basic_info.applicant_type,applicant_number:a.value.basic_info.applicant_number,applicant:a.value.basic_info.applicant,email:a.value.basic_info.email,phone_number:a.value.basic_info.phone_number,applicant_source:a.value.basic_info.applicant_source,content:a.value.vehicle_registered_list},$.value=!0,$.value?(console.log(F.value),u.clear(),Q.push("/application-success")):(a.value.vehicle_registered_list=u.vehicle_registered_list,a.value.document_list=[...t],console.log(a.value),k.value=!0)}const $=r(!1),k=r(!1);function q(){k.value=!1}return(t,o)=>{var f;return n(),i(g,null,[e("section",null,[e("p",te,l(t.$t("pages.applyFacultyStudentParking.uploadDocuments.plate_registered")),1),e("div",ae,[e("ul",null,[(n(!0),i(g,null,C(a.value.vehicle_registered_list,(s,c)=>{var _;return n(),i("li",{key:c},[e("div",le,[e("p",se,[s.plate!="腳踏車"?(n(),i("span",oe,l(s.plate),1)):y("",!0),s.car_type_title==="腳踏車"?(n(),i("span",ie,[e("span",null,l(t.$t("pages.applyFacultyStudentParking.vehicle_registration.main_pass_bike")),1),e("span",null," "+l(s.bike_num||0)+" ",1),e("span",null,l(t.$t("pages.applyFacultyStudentParking.vehicle_registration.unit")),1)])):(n(),i("span",ne,l(((_=M.find(P=>P.code===s.main_pass_code))==null?void 0:_.des)||"未知"),1))]),e("button",{class:"btn btn-dark",onClick:P=>E(c)},l(t.$t("pages.applyFacultyStudentParking.vehicle_registration.delete")),9,ce)])])}),128))])]),e("div",de,[e("div",ue,[e("div",re,[e("div",pe,[e("h5",_e,l(t.$t("pages.applyFacultyStudentParking.vehicle_registration.delete_confirm_title")),1),e("button",{type:"button",class:"btn-close",onClick:h,"aria-label":"Close"})]),e("div",me,[e("p",null,[d.value.plate!="腳踏車"?(n(),i("span",ve,l(d.value.plate),1)):y("",!0),d.value.car_type_title==="腳踏車"?(n(),i("span",fe,[e("span",null,l(t.$t("pages.applyFacultyStudentParking.vehicle_registration.main_pass_bike")),1),e("span",null," "+l(d.value.bike_num||0)+" ",1),e("span",null,l(t.$t("pages.applyFacultyStudentParking.vehicle_registration.unit")),1)])):(n(),i("span",ge,l(((f=M.find(s=>s.code===d.value.main_pass_code))==null?void 0:f.des)||"未知"),1))]),e("p",null,l(t.$t("pages.applyFacultyStudentParking.vehicle_registration.delete_confirm_content")),1)]),e("div",ye,[e("p",{class:"pointer text-primary fw-bold",onClick:h},l(t.$t("pages.applyFacultyStudentParking.vehicle_registration.cancel")),1),e("p",{class:"pointer text-primary fw-bold",onClick:U},l(t.$t("pages.applyFacultyStudentParking.vehicle_registration.delete")),1)])])])])]),e("form",be,[e("div",he,[e("label",ke,l(t.$t("pages.applyFacultyStudentParking.uploadDocuments.distance")),1),S(e("select",{class:"form-select","onUpdate:modelValue":o[0]||(o[0]=s=>a.value.selectedCommuteDistance=s)},[(n(),i(g,null,C(B,s=>e("option",{key:s,value:s},l(s),9,Ce)),64))],512),[[J,a.value.selectedCommuteDistance]])]),e("div",Se,[e("p",null,l(t.$t("pages.applyFacultyStudentParking.uploadDocuments.upload")),1),(n(!0),i(g,null,C(a.value.document_list,(s,c)=>(n(),i("div",{key:c,class:"bg-secondary mb-3 d-flex justify-content-around justify-content-md-center align-items-center upload position-relative pointer",onClick:_=>!s&&t.$refs[`fileInput${c}`][0].click()},[e("p",De,l((s==null?void 0:s.name)||t.$t("pages.applyFacultyStudentParking.uploadDocuments.upload")+(c+1)),1),s?y("",!0):(n(),i("div",Fe,o[3]||(o[3]=[e("img",{src:Z,alt:"upload"},null,-1)]))),s?(n(),i("button",{key:1,type:"button",class:"btn btn-sm position-absolute top-25 end-0",onClick:W(_=>j(c),["stop"])}," X ",8,$e)):y("",!0),e("input",{type:"file",ref_for:!0,ref:`fileInput${c}`,class:"d-none",onChange:_=>N(_,c)},null,40,Pe)],8,Me))),128))]),e("div",we,[R(l(t.$t("pages.applyFacultyStudentParking.uploadDocuments.campusToReceiveCertificate"))+" ",1),e("div",Re,[e("div",Te,[S(e("input",{class:"form-check-input",type:"radio",id:"campusToReceiveCertificate1","onUpdate:modelValue":o[1]||(o[1]=s=>a.value.campusToReceiveCertificate=s),value:"1"},null,512),[[T,a.value.campusToReceiveCertificate]]),e("label",Ae,l(t.$t("pages.applyFacultyStudentParking.uploadDocuments.primaryCampus")),1)]),e("div",Ve,[S(e("input",{class:"form-check-input",type:"radio",id:"campusToReceiveCertificate2","onUpdate:modelValue":o[2]||(o[2]=s=>a.value.campusToReceiveCertificate=s),value:"2"},null,512),[[T,a.value.campusToReceiveCertificate]]),e("label",Le,l(t.$t("pages.applyFacultyStudentParking.uploadDocuments.nanDaCampus")),1)])])]),e("div",Ie,[e("button",{type:"button",class:K(["btn btn-secondary fw-bold w-100",{btn:!0,"btn-dark":!p.value,"btn-secondary":p.value,"fw-bold":p.value,"w-100":!0}]),style:O({color:p.value?"#702f9f":"lightgray"}),onClick:L},[o[4]||(o[4]=e("i",{class:"bi bi-check-circle"},null,-1)),R(" "+l(t.$t("pages.applyFacultyStudentParking.uploadDocuments.certificateApplicationInstructionsRead")),1)],6)])]),e("div",Ee,[e("div",Ue,[e("div",Be,[e("div",Ne,[e("h5",je,l(t.$t("pages.applyFacultyStudentParking.uploadDocuments.certificateApplicationInstructionsTitle")),1),e("button",{type:"button",class:"btn-close",onClick:b,"aria-label":"Close"})]),e("div",ze,[A(x,{pdfUrl:xe})]),e("div",He,[e("p",{class:"pointer text-primary fw-bold",onClick:b},l(t.$t("pages.applyFacultyStudentParking.uploadDocuments.cancel")),1),e("p",{class:"pointer text-primary fw-bold",onClick:I},l(t.$t("pages.applyFacultyStudentParking.uploadDocuments.confirm")),1)])])])]),e("div",Xe,[e("button",{class:"btn btn-secondary w-100",disabled:!p.value,"data-bs-toggle":"modal","data-bs-target":"#comfirmModal"},l(t.$t("pages.applyFacultyStudentParking.uploadDocuments.apply")),9,qe)]),e("div",Ge,[e("div",Je,[e("div",Ke,[e("div",Oe,[e("h5",Qe,l(t.$t("pages.applyFacultyStudentParking.uploadDocuments.confirm_title")),1),o[5]||(o[5]=e("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1))]),e("div",We,l(t.$t("pages.applyFacultyStudentParking.uploadDocuments.confirm_message")),1),e("div",Ye,[e("p",Ze,l(t.$t("pages.applyFacultyStudentParking.uploadDocuments.cancel")),1),e("p",{class:"pointer text-primary fw-bold","data-bs-dismiss":"modal",onClick:X},l(t.$t("pages.applyFacultyStudentParking.uploadDocuments.confirm")),1)])])])]),A(Y,{showApplicatioinResultModal:k.value,onClose:q},null,8,["showApplicatioinResultModal"])],64)}}},it=G(et,[["__scopeId","data-v-b560667c"]]);export{it as default};

import{_ as q,o as s,c as i,a as e,t as a,n as V,r as p,b as C,j as Q,d as T,g as W,w as S,f as L,k as y,v as N,F,e as w,i as X}from"./index-CQWBdGBd.js";import{_ as Y,a as Z}from"./機車-D4nls2Mz.js";import{u as ee}from"./facultyStudentStore-CvsRRZPb.js";import{M as te}from"./bootstrap.esm-Ceob_0pG.js";import{_ as ae,a as le}from"./ValidationModal-C50zdgqw.js";const se="/NTHU-Parking-Event-Management/images/vehicle/%E8%85%B3%E8%B8%8F%E8%BB%8A.svg",ie={class:"fw-bold"},ne={class:"d-flex justify-content-start gap-5"},oe={__name:"VehicleType",props:{car_type_title:{type:String,required:!0}},emits:["updateCar_type_title"],setup(k,{emit:g}){const n=g;function _(m){n("updateCar_type_title",m)}return(m,o)=>(s(),i("section",null,[e("p",ie,a(m.$t("pages.applyFacultyStudentParking.vehicle_registration.vehicle_type")),1),e("div",ne,[e("div",{class:V(["d-flex flex-column align-items-center pointer",{"gray-overlay":k.car_type_title!="汽車"}]),onClick:o[0]||(o[0]=f=>_("汽車"))},o[3]||(o[3]=[e("div",{class:"img-container"},[e("img",{src:Y,alt:"汽車"})],-1)]),2),e("div",{class:V(["d-flex flex-column align-items-center pointer",{"gray-overlay":k.car_type_title!="機車"}]),onClick:o[1]||(o[1]=f=>_("機車"))},o[4]||(o[4]=[e("div",{class:"img-container"},[e("img",{src:Z,alt:"機車"})],-1)]),2),e("div",{class:V(["d-flex flex-column align-items-center pointer",{"gray-overlay":k.car_type_title!="腳踏車"}]),onClick:o[2]||(o[2]=f=>_("腳踏車"))},o[5]||(o[5]=[e("div",{class:"img-container"},[e("img",{src:se,alt:"腳踏車"})],-1)]),2)])]))}},re=q(oe,[["__scopeId","data-v-bb6d54ab"]]),de={class:"mt-3 fw-bold"},ce={class:"mt-3"},ue={key:0,class:"mb-3"},pe={for:"plate",class:"form-label"},_e={class:"text-warning"},ve={key:1,class:"mb-3"},ye={for:"main_pass_code",class:"form-label"},ge=["value"],me={key:2,class:"mb-3"},fe={for:"car_type",class:"form-label"},he=["value"],ke={key:3,class:"mb-3"},be={for:"bike_num",class:"form-label"},Se={class:"d-flex justify-content-between"},Fe=["disabled"],$e={class:"mt-3"},Pe={class:"registered-list border rounded vehicle-registration"},Me={class:"d-flex justify-content-between align-items-center px-3 py-1 mt-1"},Ve={class:"m-0 d-flex align-items-center"},Ce={key:0,class:"me-3"},Te={key:1},we={key:2},xe=["onClick"],Ee={class:"modal fade",id:"deleteModal",tabindex:"-1","aria-labelledby":"deleteModalLabel","aria-hidden":"true"},Be={class:"modal-dialog modal-dialog-centered"},Ie={class:"modal-content"},Re={class:"modal-header bg-secondary"},Ue={class:"modal-title text-black",id:"deleteModalModalLabel"},Le={class:"modal-body"},Ne={key:0,class:"me-3"},qe={key:1},je={key:2},Ae={class:"modal-footer"},He={__name:"Step2VehicleRegistration",setup(k){const g=ee(),n=p("汽車"),_=p("pages.applyFacultyStudentParking.vehicle_registration.vehicle_type_car");function m(t){n.value=t,n.value=="汽車"?_.value="pages.applyFacultyStudentParking.vehicle_registration.vehicle_type_car":n.value=="機車"?_.value="pages.applyFacultyStudentParking.vehicle_registration.vehicle_type_scooter":_.value="pages.applyFacultyStudentParking.vehicle_registration.vehicle_type_bike"}const o=[{code:"TC",des:"教職員校內汽車識別證"},{code:"TE",des:"職務宿舍區汽車識別證"},{code:"SC",des:"學生汽車識別證"},{code:"HF",des:"短期汽車識別證"},{code:"TM",des:"教職員機車識別證"},{code:"TEM",des:"職務宿舍區機車識別證"},{code:"SM",des:"學生機車識別證"}],f=p([]);function x(){f.value=o.filter(t=>n.value==="汽車"?["TC","TE","SC","HF"].includes(t.code):n.value==="機車"?["TM","TEM","SM"].includes(t.code):[])}C(()=>{x()}),Q(()=>{x()});const E=p([]);function j(){E.value=[{id:1,des:"汽油車"},{id:2,des:"油電車"},{id:3,des:"電動車"},{id:4,des:"柴油車"}]}C(()=>{j()});const c=p({plate:"",car_type:"",car_type_title:"",main_pass_code:""}),r=p([]);function A(){n.value=="腳踏車"?(c.value.plate="腳踏車",c.value.car_type=6,c.value.main_pass_code="BS",c.value.bike_num=b.value):n.value=="機車"&&(c.value.car_type=5),D()&&(c.value.car_type_title=n.value,H(c.value),c.value={},b.value=null)}function H(t){if(r.value.findIndex(u=>u.plate===t.plate&&u.plate!=="腳踏車")!==-1){alert("車牌已經存在，請重新輸入。The License Plate Number already exists, please re-enter it.");return}if(t.plate==="腳踏車"){const u=r.value.findIndex(l=>l.plate==="腳踏車");u!==-1?r.value[u]={...r.value[u],bike_num:t.bike_num}:r.value.push(t)}else r.value.push(t);z()}function z(){const t=r.value.filter(u=>u.plate==="腳踏車"),d=r.value.filter(u=>u.plate!=="腳踏車");r.value=[...d,...t]}const $=p(null),P=p(!1),B=p({});function D(){const t={plate:{required:!0},main_pass_code:{required:!0},car_type:{required:!0}};if(n.value==="腳踏車"&&(t.bike_num={required:!0}),$.value){const{isValid:d,errorsResult:u}=$.value.validateForm(c.value,t);return d||(B.value=u,P.value=!0),d}else return console.error("FormValidator reference is not correctly initialized."),!1}function G(){P.value=!1}let h=null;const v=p({});function J(t){const d=document.getElementById("deleteModal");h||(h=new te(d)),h.show(),v.value=r.value[t],v.value.index=t}function M(){h&&h.hide()}function K(){r.value.splice(v.value.index,1),M()}const b=p(null);function O(){g.setVehicleRegisteredList(r.value),console.log(r.value),X.push({name:"ApplyFacultyStudentParking_step3"})}return C(()=>{g.getVehicleRegisteredList(),r.value=g.vehicle_registered_list}),(t,d)=>{var u;return s(),i(F,null,[T(re,{car_type_title:n.value,onUpdateCar_type_title:m},null,8,["car_type_title"]),e("h3",de,a(t.$t(_.value)),1),T(le,{ref_key:"formValidatorRef",ref:$},null,512),e("form",ce,[n.value!="腳踏車"?(s(),i("div",ue,[e("label",pe,[W(a(t.$t("pages.applyFacultyStudentParking.vehicle_registration.plate"))+" ",1),e("span",_e," ( "+a(t.$t("pages.applyFacultyStudentParking.vehicle_registration.licensePlateInputFormat"))+" ) ",1)]),S(e("input",{type:"text",class:"form-control",id:"plate","onUpdate:modelValue":d[0]||(d[0]=l=>c.value.plate=l)},null,512),[[L,c.value.plate]])])):y("",!0),n.value!="腳踏車"?(s(),i("div",ve,[e("label",ye,a(t.$t("pages.applyFacultyStudentParking.vehicle_registration.main_pass_code")),1),S(e("select",{class:"form-select","onUpdate:modelValue":d[1]||(d[1]=l=>c.value.main_pass_code=l)},[(s(!0),i(F,null,w(f.value,l=>(s(),i("option",{key:l.code,value:l.code},a(l.des),9,ge))),128))],512),[[N,c.value.main_pass_code]])])):y("",!0),n.value=="汽車"?(s(),i("div",me,[e("label",fe,a(t.$t("pages.applyStaffParking.vehicle_registration.car_type")),1),S(e("select",{class:"form-select","onUpdate:modelValue":d[2]||(d[2]=l=>c.value.car_type=l)},[(s(!0),i(F,null,w(E.value,l=>(s(),i("option",{key:l.id,value:l.id},a(l.des),9,he))),128))],512),[[N,c.value.car_type]])])):y("",!0),n.value=="腳踏車"?(s(),i("div",ke,[e("label",be,a(t.$t("pages.applyFacultyStudentParking.vehicle_registration.bike_num")),1),S(e("input",{type:"number",class:"form-control",id:"bike_num","onUpdate:modelValue":d[3]||(d[3]=l=>b.value=l)},null,512),[[L,b.value]])])):y("",!0)]),e("div",Se,[e("button",{class:"btn btn-secondary",onClick:A},a(t.$t("pages.applyFacultyStudentParking.vehicle_registration.register")),1),e("button",{class:"btn btn-secondary",onClick:O,disabled:r.value.length<=0},a(t.$t("pages.applyFacultyStudentParking.vehicle_registration.next")),9,Fe)]),T(ae,{showModal:P.value,errors:B.value,onClose:G},null,8,["showModal","errors"]),e("section",null,[e("p",$e,a(t.$t("pages.applyFacultyStudentParking.vehicle_registration.plate_registered")),1),e("div",Pe,[e("ul",null,[(s(!0),i(F,null,w(r.value,(l,I)=>{var R;return s(),i("li",{key:I},[e("div",Me,[e("p",Ve,[l.plate!="腳踏車"?(s(),i("span",Ce,a(l.plate),1)):y("",!0),l.car_type_title==="腳踏車"?(s(),i("span",Te,[e("span",null,a(t.$t("pages.applyFacultyStudentParking.vehicle_registration.main_pass_bike")),1),e("span",null," "+a(l.bike_num||0)+" ",1),e("span",null,a(t.$t("pages.applyFacultyStudentParking.vehicle_registration.unit")),1)])):(s(),i("span",we,a(((R=o.find(U=>U.code===l.main_pass_code))==null?void 0:R.des)||"未知"),1))]),e("button",{class:"btn btn-dark",onClick:U=>J(I)},a(t.$t("pages.applyFacultyStudentParking.vehicle_registration.delete")),9,xe)])])}),128))])]),e("div",Ee,[e("div",Be,[e("div",Ie,[e("div",Re,[e("h5",Ue,a(t.$t("pages.applyFacultyStudentParking.vehicle_registration.delete_confirm_title")),1),e("button",{type:"button",class:"btn-close",onClick:M,"aria-label":"Close"})]),e("div",Le,[e("p",null,[v.value.plate!="腳踏車"?(s(),i("span",Ne,a(v.value.plate),1)):y("",!0),v.value.car_type_title==="腳踏車"?(s(),i("span",qe,[e("span",null,a(t.$t("pages.applyFacultyStudentParking.vehicle_registration.main_pass_bike")),1),e("span",null," "+a(v.value.bike_num||0)+" ",1),e("span",null,a(t.$t("pages.applyFacultyStudentParking.vehicle_registration.unit")),1)])):(s(),i("span",je,a(((u=o.find(l=>l.code===v.value.main_pass_code))==null?void 0:u.des)||"未知"),1))]),e("p",null,a(t.$t("pages.applyFacultyStudentParking.vehicle_registration.delete_confirm_content")),1)]),e("div",Ae,[e("p",{class:"pointer text-primary fw-bold",onClick:M},a(t.$t("pages.applyFacultyStudentParking.vehicle_registration.cancel")),1),e("p",{class:"pointer text-primary fw-bold",onClick:K},a(t.$t("pages.applyFacultyStudentParking.vehicle_registration.delete")),1)])])])])])],64)}}},Oe=q(He,[["__scopeId","data-v-e616ae65"]]);export{Oe as default};
